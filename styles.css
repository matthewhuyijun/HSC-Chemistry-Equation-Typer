:root {
  color-scheme: light;
  --page-max-width: 2280px;
  --page-pad-x: 24px;
  --content-max: var(--page-max-width);
  --content-pad-x: var(--page-pad-x);
  --bg: #f8fafc;
  --card: #ffffff;
  --ink: #111827;
  --muted: #6b7280;
  --brand: #2563eb;
  --brand-ink: #ffffff;
  --border: #e2e8f0;
  --key-bg: rgba(255, 255, 255, 0.9);
  --copy-bg: #ffffff;
  --copy-border: rgba(15, 23, 42, 0.15);
  --copy-ink: #0f172a;
  --copy-hover-bg: var(--brand);
  --copy-hover-ink: var(--brand-ink);
  --copy-hover-border: rgba(37, 99, 235, 0.65);
  --color-header-bg: var(--brand);
  --color-header-text: var(--brand-ink);
  --color-surface: var(--card);
  --color-border: var(--border);
  --color-tab-active-bg: var(--brand);
  --color-tab-active-text: var(--brand-ink);
  --wallpaper-light: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='28' height='28' viewBox='0 0 28 28'><rect width='100%' height='100%' fill='none'/><circle cx='14' cy='14' r='0.75' fill='%23cbd5e1' opacity='0.55'/></svg>");
  --wallpaper-dark: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='28' height='28' viewBox='0 0 28 28'><rect width='100%' height='100%' fill='none'/><circle cx='14' cy='14' r='0.75' fill='%23334155' opacity='0.55'/></svg>");
  --wallpaper: var(--wallpaper-light);
  --scale: 1.1;
}
[data-theme="dark"] {
  color-scheme: dark;
  --bg: #0f172a;
  --card: #1e293b;
  --ink: #e2e8f0;
  --muted: #94a3b8;
  --brand: #1d4ed8;
  --brand-ink: #f8fafc;
  --border: #334155;
  --key-bg: rgba(30, 41, 59, 0.9);
  --copy-bg: rgba(15, 23, 42, 0.85);
  --copy-border: rgba(148, 163, 184, 0.45);
  --copy-ink: #f8fafc;
  --copy-hover-bg: var(--brand);
  --copy-hover-ink: var(--brand-ink);
  --copy-hover-border: rgba(37, 99, 235, 0.65);
  --color-header-bg: var(--brand);
  --color-header-text: var(--brand-ink);
  --color-surface: var(--card);
  --color-border: var(--border);
  --color-tab-active-bg: var(--brand);
  --color-tab-active-text: var(--brand-ink);
  --wallpaper: var(--wallpaper-dark);
}
* {
  box-sizing: border-box;
}
html, body { overflow: hidden; overscroll-behavior: none; touch-action: pan-y; }
body {
  font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Ubuntu, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif;
  margin: 0;
  background: var(--bg);
  color: var(--ink);
  transition: background 0.3s ease, color 0.3s ease;
  font-size: calc(16px * var(--scale));
}
header {
  padding: calc(12px * var(--scale)) 0;
  background: linear-gradient(135deg, #2563eb, #3b82f6 60%, #6366f1);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
}
.header-inner {
  width: 100%;
  max-width: var(--page-max-width);
  margin: 0 auto;
  padding: 0 var(--page-pad-x);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: calc(12px * var(--scale));
}
header h1 {
  font-size: calc(18px * var(--scale));
  margin: 0;
  font-weight: 700;
  color: #ffffff;
}
header .header-left {
  display: flex;
  align-items: center;
  gap: calc(12px * var(--scale));
  flex-wrap: wrap;
}
.header-actions {
  display: flex;
  gap: calc(12px * var(--scale));
  flex-wrap: wrap;
}
.header-controls {
  display: flex;
  align-items: center;
  gap: calc(16px * var(--scale));
}
#status {
  font-size: calc(14px * var(--scale));
  font-weight: 600;
  opacity: 0.95;
  color: var(--brand-ink);
}
.visually-hidden {
  position: absolute !important;
  height: 1px;
  width: 1px;
  overflow: hidden;
  clip: rect(1px, 1px, 1px, 1px);
  white-space: nowrap;
  border: 0;
  padding: 0;
  margin: -1px;
}
.theme-switch{
  display: flex;
  align-items: center;
  gap: 4px;
}
.theme-opt{
  appearance: none;
  min-height: 36px;
  min-width: 36px;
  padding: 6px;
  border-radius: 8px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  color: rgba(255, 255, 255, 0.85);
  cursor: pointer;
  transition: all 0.2s ease;
}
.theme-opt.is-active{
  background: rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 1);
}
.theme-opt:hover{ 
  background: rgba(255, 255, 255, 0.15);
  color: rgba(255, 255, 255, 1);
}
.theme-opt:active {
  background: rgba(255, 255, 255, 0.25);
}
.theme-opt svg {
  width: 18px;
  height: 18px;
  display: block;
  stroke: currentColor;
  stroke-width: 2;
  fill: none;
  transition: transform 0.2s ease;
}
.theme-opt:hover svg {
  transform: scale(1.1);
}
main {
  width: 100%;
  max-width: var(--content-max);
  margin-left: auto;
  margin-right: auto;
  margin-top: calc(18px * var(--scale));
  margin-bottom: calc(18px * var(--scale));
  padding-left: var(--content-pad-x);
  padding-right: var(--content-pad-x);
  padding-bottom: calc(24px * var(--scale));
  display: grid;
  gap: calc(12px * var(--scale));
}
.panel,
.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: calc(12px * var(--scale));
  overflow: hidden;
  box-shadow: 0 1px 1px rgba(15, 23, 42, 0.06);
}
.panel .head {
  padding: calc(10px * var(--scale)) calc(12px * var(--scale));
  border-bottom: 1px solid var(--border);
  font-weight: 600;
  display: flex;
  justify-content: center;
  align-items: center;
  color: var(--ink);
  text-align: center;
}
.panel .body,
.card .body {
  padding: calc(12px * var(--scale));
}
math-field,
textarea {
  font-size: calc(18px * var(--scale));
  padding: calc(10px * var(--scale));
  border: 1px solid var(--border);
  border-radius: calc(10px * var(--scale));
  background: var(--card);
  color: var(--ink);
  width: 100%;
  transition: border-color 0.2s ease, background 0.2s ease;
}
math-field {
  min-height: calc(52px * var(--scale));
}
textarea {
  min-height: calc(52px * var(--scale));
  resize: none;
}
#ta {
  min-height: calc(52px * var(--scale));
}
.preview-card .body {
  padding: 0;
}
#preview {
  min-height: calc(52px * var(--scale));
  padding: calc(16px * var(--scale));
}
.row {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: calc(10px * var(--scale));
  align-items: center;
}
.btn {
  padding: calc(4px * var(--scale)) calc(8px * var(--scale));
  border: 1px solid var(--border);
  border-radius: calc(6px * var(--scale));
  background: var(--card);
  cursor: pointer;
  font-size: calc(12px * var(--scale));
  color: var(--ink);
}
.btn:active {
  transform: translateY(calc(1px * var(--scale)));
}
.btn:focus-visible {
  outline: calc(2px * var(--scale)) solid var(--brand);
  outline-offset: calc(2px * var(--scale));
}
.btn:hover,
.btn:focus-visible {
  background: var(--copy-hover-bg);
  border-color: var(--copy-hover-border);
  color: var(--copy-hover-ink);
}
.copyBtn,
.header-copy {
  appearance: none;
  align-items: center;
  justify-content: center;
  display: inline-flex;
  gap: calc(6px * var(--scale));
  padding: calc(8px * var(--scale)) calc(18px * var(--scale));
  border-radius: calc(999px * var(--scale));
  border: 1px solid var(--copy-border);
  background: var(--copy-bg);
  color: var(--copy-ink);
  font-size: 1em;
  font-weight: 600;
  cursor: pointer;
  letter-spacing: -0.01em;
  box-shadow: 0 calc(6px * var(--scale)) calc(18px * var(--scale)) rgba(15, 23, 42, 0.25);
  transition: background 0.18s ease, color 0.18s ease, box-shadow 0.18s ease, transform 0.12s ease, border-color 0.18s ease;
}
.copyBtn {
  font-size: calc(12px * var(--scale));
}
.header-copy {
  appearance: none;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 11px 24px;
  border-radius: 999px;
  background-color: #ffffff;
  border: none;
  color: #1e293b;
  font-weight: 700;
  font-size: 15px;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15), 0 1px 3px rgba(0, 0, 0, 0.1);
}
.copyBtn:hover,
.copyBtn:focus-visible {
  background: color-mix(in srgb, var(--color-tab-active-bg) 25%, var(--copy-bg));
  border-color: var(--color-tab-active-bg);
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.25);
  transform: translateY(-1px);
}
.header-copy:hover {
  transform: translateY(-1px);
}
.header-copy:focus-visible {
  background-color: #f8fafc;
  outline: 2px solid rgba(255, 255, 255, 0.5);
  outline-offset: 2px;
  transform: translateY(-1px);
}

[data-theme="dark"] .header-copy:focus-visible {
  background-color: var(--card) !important;
  outline: 2px solid rgba(255, 255, 255, 0.3);
}
.copyBtn:focus-visible {
  outline: calc(2px * var(--scale)) solid rgba(37, 99, 235, 0.6);
  outline-offset: calc(2px * var(--scale));
}
.copyBtn:active {
  box-shadow: 0 calc(2px * var(--scale)) calc(8px * var(--scale)) rgba(15, 23, 42, 0.25);
}
.header-copy:active {
  background-color: #e2e8f0;
  transform: translateY(0);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

[data-theme="dark"] .header-copy:active {
  background-color: var(--card) !important;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

/* Dark mode header buttons */
[data-theme="dark"] .header-copy {
  background-color: var(--card) !important;
  border: 1px solid var(--border) !important;
  color: var(--ink) !important;
}

[data-theme="dark"] .header-copy:hover {
  background: #1d4ed8 !important;
  border-color: #1d4ed8 !important;
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.25) !important;
  transform: translateY(-1px) !important;
}
#keyboard {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(0, 1fr));
  gap: calc(8px * var(--scale));
  width: 100%;
}
.key {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: calc(48px * var(--scale));
  padding: calc(6px * var(--scale)) calc(12px * var(--scale));
  background: var(--key-surface);
  border: 1px solid var(--key-border);
  border-radius: calc(6px * var(--scale));
  cursor: pointer;
  font-size: calc(13px * var(--scale));
  width: 100%;
  color: var(--ink);
  transition: background 0.18s ease, color 0.18s ease, border-color 0.18s ease, box-shadow 0.18s ease, transform 0.12s ease;
}
.key mjx-container {
  font-size: calc(16px * var(--scale));
  max-width: 100%;
}
.key:hover,
.key:focus-visible {
  background: color-mix(in srgb, var(--color-tab-active-bg) 25%, var(--key-surface));
  border-color: var(--color-tab-active-bg);
  transform: translateY(calc(-1px * var(--scale)));
}
.key:active {
  transform: translateY(calc(1px * var(--scale)));
}
.hint { font-size: calc(12px * var(--scale)); color: var(--muted); margin-top: calc(4px * var(--scale)); }
.editor {
  display: grid;
  gap: calc(6px * var(--scale));
}
.editor label {
  display: flex;
  align-items: center;
  gap: calc(8px * var(--scale));
  font-size: calc(13px * var(--scale));
  color: var(--muted);
}
.editor label strong {
  font-weight: 600;
  color: var(--ink);
}
.editor .copyBtn {
  margin-left: auto;
}
.stack {
  display: grid;
  gap: calc(16px * var(--scale));
}
math-field::part(virtual-keyboard-toggle),
math-field::part(menu-toggle),
math-field::part(toolbar) {
  display: none !important;
}

/* === Pretty-up pack (drop-in overrides) === */

/* Font & smoother text rendering */
html, body {
  font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Subtle gradient background that adapts to theme */
:root {
  --bg-grad-1: radial-gradient(1200px 600px at 10% -10%, rgba(37, 99, 235, 0.10), transparent 60%),
               radial-gradient(900px 500px at 110% 10%, rgba(99, 102, 241, 0.10), transparent 60%);
}
[data-theme="dark"] {
  --bg-grad-1: radial-gradient(1200px 600px at 10% -10%, rgba(37, 99, 235, 0.18), transparent 60%),
               radial-gradient(900px 500px at 110% 10%, rgba(99, 102, 241, 0.18), transparent 60%);
}
body {
  background-image: var(--bg-grad-1), var(--wallpaper);
  background-size: auto, 28px 28px;
  background-attachment: fixed, fixed;
  background-position: center, center;
  background-repeat: no-repeat, repeat;
}

/* Header glow-up */
header {
  background: linear-gradient(135deg, var(--color-header-bg), #3b82f6 55%, #6366f1);
  box-shadow: 0 8px 20px rgba(2, 6, 23, 0.28);
}
header h1 {
  letter-spacing: -0.01em;
  font-size: 20px;
  line-height: 1.2;
  position: relative;
}
header h1::after {
  content: "";
  position: absolute;
  left: 0; bottom: -6px;
  width: 100px; height: 3px;
  border-radius: 999px;
  background: linear-gradient(90deg, #ffffffaa, #c7d2fe 60%, transparent);
  filter: blur(.3px);
}

/* Panels & cards with glassy feel */
.panel,
.card {
  border-radius: 18px;
  backdrop-filter: saturate(1.1) blur(6px);
  background: color-mix(in srgb, var(--color-surface) 86%, transparent);
  border: 1px solid color-mix(in srgb, var(--color-border) 70%, transparent);
  transition: transform .15s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease;
}
.panel:hover,
.card:hover {
  transform: none;
  box-shadow: 0 16px 30px rgba(8, 15, 35, 0.18);
  background: color-mix(in srgb, var(--color-surface) 92%, transparent);
}

/* Inputs: clearer focus ring */
math-field, textarea {
  border-radius: 10px;
  box-shadow: 0 1px 0 rgba(2, 6, 23, 0.04);
}
math-field:focus-within, textarea:focus {
  outline: 2px solid color-mix(in srgb, var(--color-tab-active-bg) 60%, white);
  outline-offset: 2px;
  border-color: var(--color-tab-active-bg);
}

/* Preview surface */
#preview {
  border-radius: 14px;
  background: color-mix(in srgb, var(--color-surface) 92%, transparent);
  border: 1px solid color-mix(in srgb, var(--color-border) 70%, transparent);
}

/* Copy buttons */
.copyBtn, .header-copy {
  letter-spacing: 0;
  border-radius: 12px;
  padding: 9px 18px;
  box-shadow: 0 10px 24px rgba(2, 6, 23, 0.2);
}

/* Keyboard keys */
.key {
  border-radius: 14px;
  box-shadow: 0 10px 22px rgba(2, 6, 23, 0.12);
  transition: transform .12s ease, box-shadow .12s ease, background-color .2s ease, border-color .2s ease;
}


/* === Copy toast styles === */
#toast {
  position: fixed;
  left: 50%;
  bottom: 40px;
  transform: translateX(-50%) translateY(40px);
  background: rgba(34,197,94,0.95); /* green success */
  color: #fff;
  padding: 10px 18px;
  border-radius: 999px;
  font-size: 14px;
  font-weight: 700;
  letter-spacing: 0.01em;
  box-shadow: 0 12px 28px rgba(2,6,23,0.25);
  opacity: 0;
  pointer-events: none;
  transition: opacity .25s ease, transform .25s ease;
  z-index: 9999;
}
#toast.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

/* Responsive styles for smaller screens */
@media (max-width: 640px) {
  :root {
    --page-pad-x: 16px;
    --content-pad-x: var(--page-pad-x);
  }
}

/* === EXACT Ext2 key glow – copied verbatim === */
/* Tokens used by Ext2 keys */
:root {
  --key-surface: rgba(255, 255, 255, 0.96);
  --key-border: rgba(148, 163, 184, 0.38);
}
[data-theme="dark"] {
  --key-surface: rgba(30, 44, 76, 0.92);
  --key-border: rgba(84, 105, 150, 0.55);
}

/* Base key look from Ext2 */
.key {
  border-radius: 14px;
  border: 1px solid var(--key-border);
  background: var(--key-surface);
  box-shadow: 0 10px 22px rgba(2, 6, 23, 0.12);
  transition:
    transform .12s ease,
    box-shadow .12s ease,
    background-color .2s ease,
    border-color .2s ease;
}

/* Ext2 hover (no ring/filter, fixed -1px lift, specific shadow) */
.key:hover,
.key:focus-visible {
  background: color-mix(in srgb, var(--color-tab-active-bg) 25%, var(--key-surface));
  border-color: var(--color-tab-active-bg);
  transform: translateY(-1px);
  box-shadow: 0 12px 22px rgba(15, 23, 42, 0.18);
  filter: none;
  outline: none;
}

/* === TABS SECTION === */
.tab {
  padding: 10px 16px;
  border: 1px solid var(--color-border);
  border-radius: 12px;
  cursor: pointer;
  background: var(--color-tab-bg);
  color: var(--color-tab-text);
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  font-size: 12px;
  font-weight: 600;
  transition: background .2s ease, border-color .2s ease, box-shadow .2s ease, transform .15s ease;
  flex: 1;
  min-width: 0;
  text-align: center;
  width: 100%;
  max-width: none;
}

/* === EXT2-style hover glow for Chemistry tabs === */
.tab:hover,
.tab:focus-visible {
  background: color-mix(in srgb, var(--color-tab-active-bg) 25%, var(--color-tab-bg));
  border-color: var(--color-tab-active-bg);
  transform: translateY(-1px);
  box-shadow: 0 12px 22px rgba(15, 23, 42, 0.18);
  filter: drop-shadow(0 0 10px rgba(37,99,235,0.35));
}

/* === Ext2-identical header button glow (light & dark) === */
.header-copy {
  border: 1px solid var(--copy-border);
  background: var(--copy-bg);
  color: var(--copy-ink);
  box-shadow: 0 6px 18px rgba(15, 23, 42, 0.25);
  transition: background .18s ease, color .18s ease, box-shadow .18s ease, transform .12s ease, border-color .18s ease;
}
.header-copy:hover,
.header-copy:focus-visible {
  background: color-mix(in srgb, var(--color-tab-active-bg) 25%, var(--copy-bg));
  border-color: var(--color-tab-active-bg);
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.25);
  transform: translateY(-1px);
  outline: 2px solid rgba(37, 99, 235, 0.6);
  outline-offset: 2px;
}
.header-copy:active { box-shadow: 0 2px 8px rgba(15, 23, 42, 0.25); transform: translateY(0); }

/* Dark mode: apply the exact same recipe (tokens swap under dark) */
[data-theme="dark"] .header-copy,
[data-theme="dark"] .header-copy:hover,
[data-theme="dark"] .header-copy:focus-visible {
  background: color-mix(in srgb, var(--color-tab-active-bg) 25%, var(--copy-bg));
  /* ensure border/ink come from the same token set Ext2 uses */
  border-color: var(--color-tab-active-bg);
  color: var(--copy-ink);
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.25);
}

/* === EXT2-EXACT GLOW for keys + header buttons (light & dark) === */
/* Key base (from Ext2) */
.key {
  border-radius: 14px;
  border: 1px solid var(--key-border);
  background: var(--key-surface);
  box-shadow: 0 10px 22px rgba(2, 6, 23, 0.12);
  transition: transform .12s ease, box-shadow .12s ease, background-color .2s ease, border-color .2s ease;
}
/* Key hover: no neon ring, exact tint + lift + shadow */
.key:hover,
.key:focus-visible {
  background: color-mix(in srgb, var(--color-tab-active-bg) 25%, var(--key-surface));
  border-color: var(--color-tab-active-bg);
  transform: translateY(-1px);
  box-shadow: 0 12px 22px rgba(15, 23, 42, 0.18);
  outline: none;
  filter: none;
}
/* Kill any previous outlines/rings that caused the blue "neon" look */
.key:focus { outline: none; }

/* Header buttons base (match Ext2) */
.header-copy {
  border: 1px solid var(--copy-border);
  background: var(--copy-bg);
  color: var(--copy-ink);
  box-shadow: 0 6px 18px rgba(15, 23, 42, 0.25);
  transition: background .18s ease, color .18s ease, box-shadow .18s ease, transform .12s ease, border-color .18s ease;
}
/* Header buttons hover/focus: exact Ext2 recipe */
.header-copy:hover,
.header-copy:focus-visible {
  background: color-mix(in srgb, var(--color-tab-active-bg) 25%, var(--copy-bg));
  border-color: var(--color-tab-active-bg);
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.25);
  transform: translateY(-1px);
  outline: 2px solid rgba(37, 99, 235, 0.6);
  outline-offset: 2px;
  color: var(--color-tab-active-text);
}
.header-copy:active { box-shadow: 0 2px 8px rgba(15, 23, 42, 0.25); transform: translateY(0); }
.header-copy svg { stroke: currentColor; }

/* Dark mode: remove Chem overrides that broke Ext2 glow */
[data-theme="dark"] .header-copy,
[data-theme="dark"] .header-copy:hover,
[data-theme="dark"] .header-copy:focus-visible {
  background: color-mix(in srgb, var(--color-tab-active-bg) 25%, var(--copy-bg));
  border-color: var(--color-tab-active-bg);
  color: var(--color-tab-active-text);
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.25);
}

/* === EXT2-identical header buttons (light & dark) === */
.header-copy {
  border: 1px solid var(--copy-border) !important;
  background: var(--copy-bg) !important;
  color: var(--copy-ink) !important;
  box-shadow: 0 6px 18px rgba(15, 23, 42, 0.25) !important;
  transition: background .18s ease, color .18s ease,
              box-shadow .18s ease, transform .12s ease,
              border-color .18s ease !important;
}

.header-copy:hover,
.header-copy:focus-visible {
  background: color-mix(in srgb, var(--color-tab-active-bg) 25%, var(--copy-bg)) !important;
  border-color: var(--color-tab-active-bg) !important;
  box-shadow: 0 6px 16px rgba(37, 99, 235, 0.25) !important;
  transform: translateY(-1px) !important;
  outline: 2px solid rgba(37, 99, 235, 0.6) !important;
  outline-offset: 2px !important;
}

.header-copy:active {
  box-shadow: 0 2px 8px rgba(15, 23, 42, 0.25) !important;
  transform: translateY(0) !important;
}

/* ensure icons follow text color like Ext2 */
.header-copy svg { stroke: currentColor; }

/* === ChemistryTyper header buttons with E2-style dark glow === */
.header-actions .header-copy {
  border: 1px solid var(--copy-border);
  background: var(--copy-bg);
  color: var(--copy-ink);
  border-radius: 999px;
  box-shadow: 0 8px 20px rgba(2, 6, 23, 0.15);
  transition:
    background 0.18s ease,
    border-color 0.18s ease,
    box-shadow 0.18s ease,
    transform 0.12s ease,
    color 0.18s ease;
}

/* --- Hover / Focus: exact E2 blue highlight --- */
.header-actions .header-copy:hover,
.header-actions .header-copy:focus-visible {
  background: color-mix(in srgb, var(--color-tab-active-bg) 25%, var(--copy-bg));
  border-color: var(--color-tab-active-bg);
  transform: translateY(-1px);
  box-shadow:
    0 8px 20px rgba(37, 99, 235, 0.25),
    0 0 30px rgba(37, 99, 235, 0.3);
  outline: none;
  color: var(--copy-ink);
}

/* --- Active press --- */
.header-actions .header-copy:active {
  transform: translateY(0);
  box-shadow: 0 4px 10px rgba(37, 99, 235, 0.2);
}

/* --- Dark mode --- */
[data-theme="dark"] .header-actions .header-copy {
  background: var(--copy-bg);
  border: 1px solid var(--copy-border);
  color: var(--copy-ink);
}

[data-theme="dark"] .header-actions .header-copy:hover,
[data-theme="dark"] .header-actions .header-copy:focus-visible {
  background: color-mix(in srgb, var(--color-tab-active-bg) 25%, var(--copy-bg));
  border-color: var(--color-tab-active-bg);
  transform: translateY(-1px);
  box-shadow:
    0 8px 20px rgba(37, 99, 235, 0.35),
    0 0 40px rgba(37, 99, 235, 0.45);
  outline: none;
  color: var(--copy-ink);
}

/* === Chem header buttons: EXACT Ext2 glow === */
header .header-actions .header-copy{
  border: 1px solid var(--copy-border) !important;
  background: var(--copy-bg) !important;
  color: var(--copy-ink) !important;
  box-shadow: 0 6px 18px rgba(15,23,42,.25) !important;
  transition: background .18s ease, color .18s ease,
              box-shadow .18s ease, transform .12s ease,
              border-color .18s ease !important;
}

/* Hover/focus = Ext2 tint + lift (no neon ring) */
header .header-actions .header-copy:hover,
header .header-actions .header-copy:focus-visible{
  background: color-mix(in srgb, var(--color-tab-active-bg) 25%, var(--copy-bg)) !important;
  border-color: var(--color-tab-active-bg) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 12px 22px rgba(15,23,42,.18) !important; /* same depth as Ext2 keys */
  outline: none !important;     /* kill white/blue ring */
  filter: none !important;
}

/* Active press */
header .header-actions .header-copy:active{
  transform: translateY(0) !important;
  box-shadow: 0 2px 8px rgba(15,23,42,.25) !important;
}

/* Icons track text color */
header .header-actions .header-copy svg{ stroke: currentColor !important; }

